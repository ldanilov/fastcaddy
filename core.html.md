# API


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

# Caddy admin

## Initial functions

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L16"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_id

>      get_id (path)

*Get a ID full URL from a path*

``` python
host = 'jph.answer.ai'
```

``` python
get_id('jph.answer.ai')
```

    'http://localhost:2019/id/jph.answer.ai/'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L23"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_path

>      get_path (path)

*Get a config full URL from a path*

``` python
get_path('/apps/tls/automation/policies')
```

    'http://localhost:2019/config/apps/tls/automation/policies/'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L30"
target="_blank" style="float:right; font-size:smaller">source</a>

### gid

>      gid (path='/')

*Gets the id at `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L37"
target="_blank" style="float:right; font-size:smaller">source</a>

### has_id

>      has_id (id)

*Check if `id` is set up*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L44"
target="_blank" style="float:right; font-size:smaller">source</a>

### gcfg

>      gcfg (path='/', method='get')

*Gets the config at `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L52"
target="_blank" style="float:right; font-size:smaller">source</a>

### has_path

>      has_path (path)

*Check if `path` is set up*

``` python
gcfg()
```

``` json
{ 'apps': { 'tls': { 'automation': { 'policies': [{'issuers': [{'challenges': {'dns': {'provider': {'api_token': 'yxeyTR9lZY9e265KHtoVjhMI23lh586PLBz1NxaA', 'name': 'cloudflare'}}}, 'module': 'acme'}]}]}}}}
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L59"
target="_blank" style="float:right; font-size:smaller">source</a>

### pid

>      pid (d, path='/', method='post')

*Puts the config `d` into `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L67"
target="_blank" style="float:right; font-size:smaller">source</a>

### pcfg

>      pcfg (d, path='/', method='post')

*Puts the config `d` into `path`*

``` python
pcfg({})
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L75"
target="_blank" style="float:right; font-size:smaller">source</a>

### nested_setdict

>      nested_setdict (sd, value, *keys)

*Returns `sd` updated to set `value` at the path `keys`*

``` python
nested_setdict({'a':'b'}, {'c':'d'}, 'apps', 'http', 'servers', 'srv0')
```

    {'a': 'b', 'apps': {'http': {'servers': {'srv0': {'c': 'd'}}}}}

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L83"
target="_blank" style="float:right; font-size:smaller">source</a>

### path2keys

>      path2keys (path)

*Split `path` by ‘/’ into a list*

``` python
path2keys('/apps/tls/automation/policies')
```

    ['apps', 'tls', 'automation', 'policies']

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L88"
target="_blank" style="float:right; font-size:smaller">source</a>

### keys2path

>      keys2path (*keys)

*Join `keys` into a ‘/’ separated path*

``` python
keys2path('apps', 'tls', 'automation', 'policies')
```

    '/apps/tls/automation/policies'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L93"
target="_blank" style="float:right; font-size:smaller">source</a>

### nested_setcfg

>      nested_setcfg (value, *keys)

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L98"
target="_blank" style="float:right; font-size:smaller">source</a>

### init_path

>      init_path (path, skip=0)

## Acme setup

``` python
cf_token = os.environ['AAI_CF_TOKEN']
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L107"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_acme_config

>      get_acme_config (token)

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L115"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_acme_config

>      add_acme_config (cf_token)

``` python
add_acme_config(cf_token)
```

``` python
gcfg('/apps/tls/automation/policies')[0]
```

``` json
{ 'issuers': [{'challenges': {'dns': {'provider': {'api_token': 'yxeyTR9lZY9e265KHtoVjhMI23lh586PLBz1NxaA', 'name': 'cloudflare'}}}, 'module': 'acme'}]}
```

## Route setup

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L126"
target="_blank" style="float:right; font-size:smaller">source</a>

### init_routes

>      init_routes (srv_name='srv0')

*Create basic http server/routes config*

``` python
init_routes()
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L134"
target="_blank" style="float:right; font-size:smaller">source</a>

### setup_caddy

>      setup_caddy (cf_token, srv_name='srv0')

*Create SSL config and HTTP app skeleton*

``` python
gcfg(srvs_path)
```

``` json
{'srv0': {'listen': [':80', ':443'], 'routes': []}}
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L140"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_route

>      add_route (route)

*Add `route` dict to config*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L145"
target="_blank" style="float:right; font-size:smaller">source</a>

### del_id

>      del_id (id)

*Delete route for `id` (e.g. a host)*

``` python
# del_id(host)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L150"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_reverse_proxy

>      add_reverse_proxy (from_host, to_url)

*Create a reverse proxy handler*

``` python
add_reverse_proxy(host, "localhost:5001")
```

``` python
gcfg(rts_path)
```

    (#1) [{'@id': 'jph.answer.ai', 'handle': [{'handler': 'reverse_proxy', 'upstreams': [{'dial': 'localhost:5001'}]}], 'match': [{'host': ['jph.answer.ai']}], 'terminal': True}]

``` python
gid(host)
```

``` json
{ '@id': 'jph.answer.ai',
  'handle': [{'handler': 'reverse_proxy', 'upstreams': [{'dial': 'localhost:5001'}]}],
  'match': [{'host': ['jph.answer.ai']}],
  'terminal': True}
```
